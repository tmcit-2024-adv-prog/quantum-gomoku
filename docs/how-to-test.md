# テストについて

## テストの種類

### ユニットテスト

単体テストとも呼ばれ、プログラムの最小単位である関数やメソッドなどを単体でテストすることです。

### シナリオテスト

複数のクラスや関数を組み合わせて実際のシナリオを再現することで、システム全体の挙動をテストすることです。

## 単体テストの実装について

今回はJavaの単体テストフレームワークであるJUnitを使用します。
`app/src/test/java/jp/ac/metro_cit/adv_prog_2024/gomoku`のディレクトリ内にテストクラスを作成し、テストメソッドを実装していきます。

テストを書くときはAAAパターンやGiven-When-Thenパターンを意識しましょう。
準備→実行→判定の流れです。

単体テストではホワイトボックステストを前提とします。
ホワイトボックステストはコードの中の構造等に着目して行なうテストです。
ホワイトボックステストで一般的に知られている観点は以下の4つがあります。

- 命令網羅：それぞれの命令文が一度は実行される
- 分岐網羅：それぞれの分岐において真偽が一度は実行される
- 条件網羅：それぞれの分岐の条件文において真偽が一度は実行される
- 複合条件網羅：それぞれの分岐の条件文のすべての組み合わせに対して実行される

個人的には上2つの命令網羅と分岐網羅がテストできていれば問題ないと思います。
条件網羅に関しては必要そうな場合にやればいいと思います。

それぞれでどれだけ網羅できているかを表すカバレッジというのがありますが、命令網羅率と分岐網羅率は85%を目安にすれば良いと思います。
どうしても網羅できない場合もあるので100%を目指す必要はありません。

### テストの例

以下は素数判定を行なうメソッドとそのテストクラスの例です。

#### 実装

```java
public class Prime {
  public boolean isPrime(int n) {
    if (n < 2) {
      return false;
    }
    for (int i = 2; i <= Math.sqrt(n); i++) {
      if (n % i == 0) {
        return false;
      }
    }
    return true;
  }
}
```

#### テスト

```java
public class PrimeTest() {
  @Test
  void testIsPrime() {
    // Primeクラスが存在
    Prime prime = new Prime();

    // 0の素数判定の結果
    boolean result = prime.isPrime(0);

    // 0は素数ではない
    assetFalse(result);

    // 2の素数判定の結果
    result = prime.isPrime(2);

    // 2は素数
    assetTrue(result);

    // 17の素数判定の結果
    result = prime.isPrime(17);

    // 17は素数
    assetTrue(result);

    // 999の素数判定の結果
    result = prime.isPrime(999);

    // 999は素数ではない
    assetFalse(result);
  }
}
```

## VSCodeを使ったカバレッジの確認

VSCodeを使用している場合はテストの網羅率（カバレッジ）を確認することができます。

左側のバーのフラスコのアイコンをクリックし、該当のテストを右クリックして「カバレッジを使用してテストを実行」を押すとカバレッジを確認することができます。
これを実行すると実装のコードの背景が色分けされ、どの部分がテストされているかがわかりやすくなります。
赤色の部分がテストされていない部分です。

<details>

<summary>カバレッジの確認方法</summary>

![](./videos/vscode-coverage.mp4)

</details>
